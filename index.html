<!DOCTYPE html>
<html lang='pt-BR'>
<head>
<meta charset='UTF-8'>
<title>Demonstrativo por Unidade</title>
<script src='https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js'></script>
<style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { text-align: center; }
    .totais { display: flex; justify-content: space-between; margin-top: 20px; }
    .debito { background-color: #c0392b; color: white; padding: 10px; flex: 1; text-align: center; margin-right: 10px; }
    .credito { background-color: #27ae60; color: white; padding: 10px; flex: 1; text-align: center; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
</style>
</head>
<body>
<h1>Demonstrativo por Unidade</h1>
<div class='totais'>
    <div class='debito'>Total Débito: R$ <span id='total-debito'>0,00</span></div>
    <div class='credito'>Total Crédito: R$ <span id='total-credito'>0,00</span></div>
</div>
<div id='table-container'></div>
<script>
    // Substitua pela URL real do arquivo Excel no GitHub Pages
    const excelUrl = 'https://SEU_USUARIO.github.io/SEU_REPOSITORIO/Impostos%20a%20pagar.xls';

    fetch(excelUrl)
        .then(response => response.arrayBuffer())
        .then(data => {
            const workbook = XLSX.read(data, { type: 'array' });
            let totalDebito = 0;
            let totalCredito = 0;
            let html = '';

            workbook.SheetNames.forEach(sheetName => {
                const sheet = workbook.Sheets[sheetName];
                const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                if (json.length > 0) {
                    html += `<h2>${sheetName}</h2><table>`;
                    json.forEach((row, rowIndex) => {
                        html += '<tr>';
                        row.forEach(cell => {
                            if (rowIndex === 0) {
                                html += `<th>${cell}</th>`;
                            } else {
                                html += `<td>${cell}</td>`;
                            }
                        });
                        html += '</tr>';

                        // Calcular totais se houver coluna TIPO e VALOR
                        if (rowIndex > 0) {
                            const tipo = row.find(c => c === 'Debito' || c === 'Débito' || c === 'Credito' || c === 'Crédito');
                            const valor = row.find(c => typeof c === 'number');
                            if (tipo && valor !== undefined) {
                                if (tipo.toLowerCase().includes('debito')) totalDebito += valor;
                                if (tipo.toLowerCase().includes('credito')) totalCredito += valor;
                            }
                        }
                    });
                    html += '</table>';
                }
            });

            document.getElementById('table-container').innerHTML = html;
            document.getElementById('total-debito').textContent = totalDebito.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
            document.getElementById('total-credito').textContent = totalCredito.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
        })
        .catch(error => console.error('Erro ao carregar Excel:', error));
</script>
</body>
</html>